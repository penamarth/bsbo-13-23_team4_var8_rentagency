Прецедент: Оставление комментария к объекту недвижимости.

Название: Оставление отзыва/комментария под объектом недвижимости.

Основной исполнитель (Actor): Квартиросъемщик (Tenant).
Второстепенные исполнители: Сущность Comment, Объект недвижимости (Property).

Предусловия:

1)Квартиросъемщик (Tenant) является зарегистрированным пользователем с ролью Tenant и выполнил вход в систему (login()).
2)В системе существует объект недвижимости (Property), к которому пользователь хочет оставить комментарий (например, квартира со статусом AVAILABLE, RENTED или UNDER_MODERATION).
3)Пользователь находится на странице просмотра деталей объекта недвижимости.

Основной поток событий:

1) Инициирование написания комментария
Квартиросъемщик нажимает кнопку/поле «Оставить комментарий» или «Написать отзыв» на странице объекта недвижимости.

2) Ввод текста комментария
Система предоставляет поле для ввода текста. Квартиросъемщик вводит текст комментария (например: «Отличная квартира! Рекомендую.»).

3) Создание объекта Comment
При нажатии кнопки «Отправить»/«Опубликовать» система выполняет следующие действия:

 1. Создаётся новый объект класса Comment.
 2. Заполняются обязательные поля:
   •	Id — генерируется уникальный идентификатор
   •	Text — введённый пользователем текст
   •	Date — текущая дата и время (DateTime.Now)
   •	Author — текущий объект Tenant
   •	Property — объект недвижимости, к которому пишется комментарий


4) Валидация комментария

Система вызывает метод AddComment() объекта Comment, который проверяет:
· !string.IsNullOrWhiteSpace(Text) — текст не пустой и не состоит только из пробелов.

5) Результат валидации

Если проверка пройдена успешно:
· Метод AddComment() возвращает true - Переход к шагу 6

Если проверка не пройдена (пустой или онли пробелы):
· Метод AddComment() возвращает false
   Система отображает сообщение об ошибке: «Текст комментария не может быть пустым»
   Прецедент завершается (исправить текст и повтор).

6) Добавление комментария к объекту недвижимости

Если валидация прошла успешно, система выполняет:
· property.Comments.Add(comment) — добавляет созданный объект Comment в коллекцию Comments объекта Property.
   Подтверждение успешного добавления
   Система:
    Обновляет страницу с отзывами и показывает новый комментарий в списке.
    Выводит сообщение об успешном действии: «Ваш комментарий добавлен».

7) Завершение прецедента
Комментарий успешно сохранён в системе и виден всем пользователям, просматривающим данный объект недвижимости.
Квартиросъемщик может продолжить просмотр других объектов или выйти из системы.

Альтернативные потоки:

А5. Ошибка валидации (пустой комментарий)
· На шаге 4 метод AddComment() возвращает false.
· Система не добавляет объект в коллекцию Comments.
· Пользователю показывается сообщение об ошибке.
· Пользователь остаётся на странице ввода комментария и может исправить текст.
· Возврат к шагу 2 (ввод текста).

А6. Техническая ошибка при добавлении
(БД)
· Добавление в коллекцию Comments не удалось (что-то с памятью или исключения).
· Система фиксирует ошибку и показывает пользователю сообщение: «Не удалось добавить комментарий. Попробуйте позже».
· Прецедент завершается с ошибкой.

Постусловия:

1. В системе создан и сохранён объект класса Comment.
2. Объект Comment добавлен в коллекцию property.Comments конкретного объекта недвижимости.
3. Новый комментарий доступен для просмотра всем пользователям на странице объекта недвижимости.
4. Автор комментария (Tenant) зарегистрирован в поле Author объекта Comment.
5. Дата создания комментария зафиксирована в поле Date.
